<!doctype html>
<html lang="en" dir="ltr">
 <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Test Your Knowledge — Quiz</title>
  <meta name="description" content="Test your knowledge with a random set of Arabic questions">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Kufi+Arabic:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/styles.css">
 </head>
 <body>
  <header class="site-header">
   <nav class="navbar" aria-label="Main navigation">
    <ul id="nav-links" class="nav-links">
     <li><a href="sign/SignUp_LogIn_Form.html">Login</a></li>
     <li><a href="QUIZ.html">Quizzes</a></li>
     <li class="dropdown">
       <a class="dropbtn">Regions</a>
       <ul class="dropdown-content">
         <li><a href="North.html">Northern Region</a></li>
         <li><a href="South.html">Southern Region</a></li>
         <li><a href="West.html">Western Region</a></li>
         <li><a href="East.html">Eastern Region</a></li>
         <li><a href="Central.html">Central Region</a></li>
       </ul>
     </li>
     <li><a href="index.html">Home</a></li>
    </ul>
    <a class="brand" href="index.html" aria-label="Home">Saudi Culture</a>
    <button class="menu-toggle" aria-expanded="false" aria-controls="nav-links" aria-label="Open/close menu">☰</button>
   </nav>
  </header>

  <main id="main">
   <section class="section section-intro">
    <div class="container">
    <h2>Test your knowledge</h2>
    <p>Choose the number of questions then start the quiz. Results will be shown after completion.</p>
     <div class="two-col" style="margin-top:1rem">
      <div>
       <label>Select number of questions:</label>
       <select id="questionCount">
         <option value="5">5 questions</option>
         <option value="10">10 questions</option>
         <option value="15">15 questions</option>
         <option value="20">20 questions</option>
       </select>
       <div style="margin-top:12px">
         <a class="btn btn-primary" id="startBtn" href="#quiz">Start Quiz</a>
       </div>
      </div>
      <div>
      <p>This quiz displays questions in Arabic from a general question bank. Questions are chosen randomly and presented as multiple-choice options.</p>
      </div>
     </div>
    </div>
   </section>

   <section id="quiz" class="section section-alt">
    <div class="container">
     <div id="quizContainer"></div>
     <div id="result" style="margin-top:1rem;font-weight:700"></div>
    </div>
   </section>
  </main>

  <footer class="site-footer" aria-label="footer">
   <div class="container footer-grid">
    <div>
     <strong>Saudi Culture</strong>
     <p>© 2025 All rights reserved</p>
    </div>
    <ul class="footer-links">
     <li><a href="#top">Back to Top</a></li>
     <li><a href="#main">Questions</a></li>
    </ul>
   </div>
  </footer>

  <script src="assets/script.js"></script>
  <script>
  // Quiz data and logic (kept inline so page works with existing assets)
  const allQuestions = [
    { question:"ما هي عاصمة السعودية؟", choices:["الرياض","جدة","مكة","الدمام"], answer:"الرياض" },
    { question:"أكبر محيط في العالم؟", choices:["الهادئ","الأطلسي","الهندي","المتجمد"], answer:"الهادئ" },
    { question:"من هو مخترع المصباح الكهربائي؟", choices:["توماس إديسون","نيوتن","أينشتاين","تسلا"], answer:"توماس إديسون" },
    { question:"كم عدد الكواكب في المجموعة الشمسية؟", choices:["7","8","9","10"], answer:"8" },
    { question:"أسرع حيوان بري؟", choices:["الفهد","الأسد","النمر","الغزال"], answer:"الفهد" },
    { question:"أين يقع برج إيفل؟", choices:["باريس","لندن","روما","برلين"], answer:"باريس" },
    { question:"ما هو أكبر كوكب في المجموعة الشمسية؟", choices:["الأرض","المشتري","زحل","الزهرة"], answer:"المشتري" },
    { question:"ما هي لغة البرمجة الأكثر استخداماً؟", choices:["Python","C++","Java","HTML"], answer:"Python" },
    { question:"ما هو أسرع طائر في العالم؟", choices:["النســر","الصقر","النعامة","الكناري"], answer:"الصقر" },
    { question:"ما هو الحيوان الذي لا يشرب الماء؟", choices:["الجمل","الكنغر","الذئب","الفهد"], answer:"الجمل" },
    { question:"ما هي العملة الرسمية في اليابان؟", choices:["ين","دولار","يورو","جنيه"], answer:"ين" },
    { question:"كم عدد الحروف في الأبجدية العربية؟", choices:["28","30","26","24"], answer:"28" },
    { question:"ما هو أكبر حيوان على الأرض؟", choices:["الحوت الأزرق","الفيل","الزرافة","القرش"], answer:"الحوت الأزرق" },
    { question:"من هو مؤسس شركة مايكروسوفت؟", choices:["بيل غيتس","ستيف جوبز","إيلون ماسك","مارك زوكربيرغ"], answer:"بيل غيتس" },
    { question:"ما هو أسرع حيوان في الماء؟", choices:["سمكة أبو سيف","الدلفين","القرش","الحوت"], answer:"سمكة أبو سيف" },
    { question:"أين تقع الأهرامات؟", choices:["مصر","المغرب","السعودية","اليمن"], answer:"مصر" },
    { question:"ما هو العنصر الكيميائي الذي رمزه O؟", choices:["أكسجين","هيدروجين","نيتروجين","ذهب"], answer:"أكسجين" },
    { question:"ما هي عاصمة فرنسا؟", choices:["باريس","لندن","روما","مدريد"], answer:"باريس" },
    { question:"من كتب رواية 1984؟", choices:["جورج أورويل","تولستوي","شكسبير","هاروكي موراكامي"], answer:"جورج أورويل" },
    { question:"ما هو الكوكب الأحمر؟", choices:["المريخ","الزهرة","المشتري","الأرض"], answer:"المريخ" }
  ];

  function shuffle(arr){
    for(let i=arr.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
  }

  let selectedQuestions = [];

  async function startQuiz(){
    const count = Number(document.getElementById('questionCount').value) || 5;
    document.getElementById('result').innerHTML = 'Loading quiz...';

    // try server-side endpoint first
    try {
      const source = 'Words'; // default source; you can make this selectable later
      const resp = await fetch(`quiz.php?source=${encodeURIComponent(source)}&count=${count}`);
      if (resp.ok) {
        const data = await resp.json();
        if (data && Array.isArray(data.questions) && data.questions.length > 0) {
          selectedQuestions = data.questions.map(q => ({
            question: q.question,
            choices: q.choices.slice(),
            answer: q.answer
          }));
          // shuffle choices for each question
          selectedQuestions.forEach(q => shuffle(q.choices));
          displayQuestions();
          document.getElementById('result').innerHTML = '';
          window.location.hash = '#quiz';
          return;
        }
      }
      // fall through to local fallback
    } catch (err) {
      // network or parse error -> fall back
      console.warn('Quiz endpoint failed, using local fallback:', err);
    }

    // fallback to embedded questions if server-side failed
    selectedQuestions = allQuestions.slice();
    shuffle(selectedQuestions);
    selectedQuestions = selectedQuestions.slice(0, count);
    selectedQuestions.forEach(q => shuffle(q.choices));
    displayQuestions();
    document.getElementById('result').innerHTML = '';
    window.location.hash = '#quiz';
  }

  function displayQuestions(){
    const container = document.getElementById('quizContainer');
    container.innerHTML = '';
    selectedQuestions.forEach((q, i) => {
      const box = document.createElement('div');
      box.className = 'feature-card';
      let html = `<h3 dir="ltr">${i+1}. ${q.question}</h3>`;
      q.choices.forEach(choice => {
        html += `<label style="display:block;margin:.25rem 0"><input type="radio" name="q${i}" value="${choice}"> ${choice}</label>`;
      });
      box.innerHTML = html;
      container.appendChild(box);
    });
    const checkBtn = document.createElement('a');
    checkBtn.className = 'btn btn-primary';
    checkBtn.textContent = 'Check Answers';
    checkBtn.href = '#result';
    checkBtn.style.display = 'inline-block';
    checkBtn.style.marginTop = '1rem';
    checkBtn.addEventListener('click', (e) => { e.preventDefault(); checkAnswers(); });
    container.appendChild(checkBtn);
  }

  function checkAnswers(){
    let score = 0;
    for(let i=0;i<selectedQuestions.length;i++){
      const sel = document.querySelector(`input[name="q${i}"]:checked`);
      if(sel && sel.value === selectedQuestions[i].answer) score++;
    }
    const total = selectedQuestions.length || 1;
    const percent = Math.round((score/total)*100);
    let color = '#1e88e5';
    if(percent >= 80) color = 'green';
    else if(percent >= 50) color = 'orange';
    else color = 'red';
    document.getElementById('result').innerHTML = `Your score: <span style="color:${color}">${score} / ${total} (${percent}%)</span>`;
  }

  // hook start button
  document.addEventListener('DOMContentLoaded', () => {
    const startBtn = document.getElementById('startBtn');
    if(startBtn) startBtn.addEventListener('click', (e) => { e.preventDefault(); startQuiz(); });
  });
  </script>
 </body>
</html>